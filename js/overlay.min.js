// Overlay js - lightweight jquery overlay plugin -version 2.0 - http://dev.codinglog.com/jquery/overlay-js/
// Copyright (c) 2011 Sandeep MT - http://mtsandeep.com
// Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
;
(function (c) {
    c.fn.extend({overlay: function (e) {
        e = c.extend({position: "fixed", background: "#000", opacity: 0.5, zIndex: 99, url: "", showAfter: 0, hideAfter: 0, close: !0, escClose: !0, remove: !1, replaceWith: "", onTrigger: function () {
        }, onLoad: function () {
        }, onClose: function () {
        }}, e);
        return this.each(function () {
            function h() {
                0 < c("#cover").length ? c("#cover").css({"background-color": a.background, opacity: a.opacity, filter: "alpha(opacity =" + 100 * a.opacity + ")"}).show() : c("body").append(k);
                i()
            }

            function i() {
                a.url && b.load(a.url, function () {
                    f()
                });
                b.css("z-index", a.zIndex + 9).addClass("overlay");
                f();
                b.fadeIn(500, function () {
                    a.onLoad(b)
                })
            }

            function f() {
                var g = c(window).height() - b.outerHeight(), j = c(window).width() - b.outerWidth();
                40 > g ? b.css({position: "absolute", top: c(window).scrollTop() + 20 + "px"}) : "fixed" == a.position ? b.css({position: a.position, top: g / 2 + "px"}) : b.css({position: a.position, top: g / 2 + c(window).scrollTop() + "px"});
                40 > j ? b.css("left", "20px") : b.css("left", j / 2 + c(window).scrollLeft() + "px");
                a.close && (b.children(".overlay-close").length ? b.children(".overlay-close").show() : b.prepend(l))
            }

            function d() {
                b.children(".overlay-close").hide();
                b.removeAttr("style").removeClass("overlay");
                c(window).unbind("resize.overlay");
                c(document).unbind("keyup.overlay");
                a.url && b.empty();
                c("#cover").fadeOut(200, function () {
                    a.onClose(b);
                    b.unbind()
                })
            }

            var a = e, b = c(this);
            a.onTrigger(b);
            var k = '<div id="cover" style="position:fixed;top:0;left:0;width:100%;height:100%;background-color:' + a.background + ";zoom:1;filter:alpha(opacity=" + 100 * a.opacity + ");opacity:" + a.opacity + ";z-index:" + a.zIndex + ';"></div>', l = '<a class="overlay-close" href="#">X</a>';
            a.replaceWith ? c(".overlay").is(":visible") && (c(".overlay").removeAttr("style").removeClass("overlay").children(".overlay-close").hide(), b = c(a.replaceWith), i()) : (a.showAfter ? setTimeout(function () {
                h()
            }, a.showAfter) : h(), a.hideAfter ? setTimeout(function () {
                d()
            }, a.showAfter + a.hideAfter) : a.remove && d());
            a.escClose && c(document).bind("keyup.overlay", function (a) {
                27 == a.which && d()
            });
            b.delegate(".overlay-close", "click", function (a) {
                a.preventDefault();
                d()
            });
            (function (a, b) {
                c(window).bind("resize.overlay", function () {
                    clearTimeout(b);
                    b = setTimeout(a, 100)
                })
            })(function () {
                f()
            })
        })
    }})
})(jQuery);